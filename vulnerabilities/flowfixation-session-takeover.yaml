title: FlowFixation
slug: flowfixation-session-takeover
cves: null
affectedPlatforms:
- AWS
affectedServices:
- Managed Workflows for Apache Airflow
image: AMITAI
severity: Critical
discoveredBy:
  name: Liv Matan
  org: Tenable
  domain: https://www.tenable.com/
  twitter: null
disclosedAt: null
publishedAt: 2024/03/21
exploitabilityPeriod: null
knownITWExploitation: false
summary: |
  Researchers identified a vulnerability named FlowFixation in AWS Managed Workflows for Apache Airflow (MWAA), now patched by AWS and dubbed FlowFixation. This flaw could have allowed potential session hijacking and remote code execution.
  Apache Airflow, a popular open-source workflow management tool, and its managed services like AWS MWAA are widely used, with significant adoption across Tenable’s customer base. This flaw could have allowed hackers to take over users' sessions and execute code on the cloud instances hosting these services. The issue stemmed from a combination of session fixation in the AWS MWAA web management panel and an AWS domain configuration error leading to a cross-site scripting (XSS) attack. Attackers exploiting this could manipulate victims' configurations, trigger workflows, and potentially move laterally to other services within the cloud environment. The exploit of this bug involves deploying malicious code via Amazon API Gateway that interacts with the victim’s Airflow instance, setting a session cookie that bypasses normal authentication and grants the attacker access. 
  The vulnerability exposed broader concerns regarding cloud providers' domain architecture, especially relating to the Public Suffix List (PSL) and vulnerabilities associated with shared domains across customers. This architecture made services prone to same-site attacks, cross-origin issues, and cookie tossing, which could result in unauthorized access and data breaches. AWS and Azure have responded by updating their domain configurations to mitigate these risks.
manualRemediation: |
  None required
detectionMethods: null
contributor: https://github.com/mer-b
references:
- https://www.tenable.com/blog/flowfixation-aws-apache-airflow-service-takeover-vulnerability-and-why-neglecting-guardrails